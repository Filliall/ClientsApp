<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:ClientsApp.ViewModels"
              xmlns:behaviors="clr-namespace:ClientsApp.Utils.Behaviors"
             x:DataType="viewmodels:EditClientViewModel"
             x:Class="ClientsApp.Views.EditClientPage"
             Title="{Binding Title}"
             BackgroundColor="Transparent">

    <Grid>
        <!-- Fundo semi-transparente que fecha o popup ao ser tocado -->
        <BoxView BackgroundColor="#80000000">
            <BoxView.GestureRecognizers>
                <TapGestureRecognizer Command="{Binding CancelAsyncCommand}" />
            </BoxView.GestureRecognizers>
        </BoxView>

        <!-- Conteúdo do Popup -->
        <Border VerticalOptions="Center" HorizontalOptions="Center"
                Stroke="{StaticResource SteampunkLeather}" StrokeThickness="2"
                BackgroundColor="{StaticResource SteampunkBackground}"
                WidthRequest="380"
                Padding="0">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="8"/>
            </Border.StrokeShape>

            <ScrollView>
                <VerticalStackLayout Spacing="10" Margin="20">
                    <Label Text="{Binding Title}" Style="{StaticResource SteampunkLabel}" FontSize="22" HorizontalOptions="Center" Margin="0,0,0,10"/>

                    <Label Text="Nome" Style="{StaticResource SteampunkLabel}" />
                    <Border Style="{StaticResource SteampunkEntryBorder}">
                        <Entry Text="{Binding Name}" Placeholder="Nome do cliente" Style="{StaticResource SteampunkEntry}">
                            <Entry.Behaviors>
                                <behaviors:AlphanumericValidationBehavior />
                            </Entry.Behaviors>
                        </Entry>
                    </Border>

                    <Label Text="Sobrenome" Style="{StaticResource SteampunkLabel}" />
                    <Border Style="{StaticResource SteampunkEntryBorder}">
                        <Entry Text="{Binding LastName}" Placeholder="Sobrenome do cliente" Style="{StaticResource SteampunkEntry}" >
                            <Entry.Behaviors>
                                <behaviors:AlphanumericValidationBehavior />
                            </Entry.Behaviors>
                        </Entry>
                    </Border>

                    <Label Text="Endereço" Style="{StaticResource SteampunkLabel}" />
                    <Border Style="{StaticResource SteampunkEntryBorder}">
                        <Entry Text="{Binding Address}" Placeholder="Endereço do cliente" Style="{StaticResource SteampunkEntry}" >
                            <Entry.Behaviors>
                                <behaviors:AlphanumericValidationBehavior />
                            </Entry.Behaviors>
                        </Entry>
                    </Border>

                    <Label Text="Idade" Style="{StaticResource SteampunkLabel}" />
                    <Border Style="{StaticResource SteampunkEntryBorder}">
                        <Entry Text="{Binding Age}" Keyboard="Numeric" Placeholder="Idade do cliente" Style="{StaticResource SteampunkEntry}" >
                            <Entry.Behaviors>
                                <behaviors:AlphanumericValidationBehavior />
                            </Entry.Behaviors>
                        </Entry>
                    </Border>

                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10" Margin="0,20,0,0">
                        <Button Grid.Column="0" Text="Cancelar" Command="{Binding CancelAsyncCommand}" IsEnabled="{Binding IsNotBusy}" Style="{StaticResource SteampunkSecondaryButton}" />
                        <Button Grid.Column="1" Text="Salvar" Command="{Binding SaveClientAsyncCommand}" IsEnabled="{Binding IsNotBusy}" Style="{StaticResource SteampunkPrimaryButton}" />
                    </Grid>

                    <ActivityIndicator IsRunning="{Binding IsBusy}" IsVisible="{Binding IsBusy}" HorizontalOptions="Center" VerticalOptions="Center" />
                </VerticalStackLayout>
            </ScrollView>
        </Border>
    </Grid>
</ContentPage>